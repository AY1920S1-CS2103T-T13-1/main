= ORGANice - User Guide
:site-section: UserGuide
:toc:
:toc-title:
:toc-placement: preamble
:sectnums:
:imagesDir: images
:stylesDir: stylesheets
:xrefstyle: full
:experimental:
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
endif::[]
:repoURL: https://github.com/AY1920S1-CS2103T-T13-1/main
:javaURL: https://www.oracle.com/technetwork/java/javase/downloads/jdk11-downloads-5066655.html

By: `CS2103T-T13-1`      Since: `Sep 2019`      Licence: `MIT`

== Introduction

This user guide explains how to use ORGANice to manage organ transplants.
ORGANice is a desktop application for hospital administration staff who prefer
to use Command Line Interface applications to manage organ transplants.

With ORGANice, you can easily do the following:

* organise information about patients, doctors, and donors
* find matches between organ donors and patients

If you are a hospital administrator and would like to use ORGANice, check out <<Quick Start>>
to get started.

== Quick Start

Below is a list of things to do to use ORGANice:

1.  Ensure you have Java `11` or above installed in your computer. +
If not, install it link:{javaURL}[here].
2.  Download the latest `organice.jar` link:{repoURL}/releases[here].
3.  Copy the JAR file to the folder you want to use as the home folder for your application.
4.  Double-click the JAR file to start the application. The application should appear in a few seconds.
Figure 1 shows how the application looks like after starting it.

.**How ORGANice looks upon starting up**

image::Ui.png[width="790"]


If what you are seeing on your screen looks like what is shown in Figure 1, congratulations! You have successfully started the application.
Now that you have have succeeded, it is time to learn about the various components in this application.

== Components of ORGANice

This section aims to introduce you to the various components of ORGANice.
We will be using Figure 2, which has all the components of ORGANice labelled.

.**Components of ORGANice**
image::ORGANiceComponents.png[width="790"]

The following list explains each component and the function of that component:

* Component: Command Box
** Function of component: the Command Box is a text box for you to type in commands. Commands are instructions to ORGANice to perform a feature.
* Component: Message Display Box
** Function of component: the Message Display Box displays messages after executing commands. These messages aim to let you know if
you have succeeded or failed in executing a command.
* Component: Person List
** Function of component: the Person List is a display of people's information stored in ORGANice. You can scroll down this list to see
more people in this application.


Now that you know the components of ORGANice, let's move on to <<List of Attributes>> to understand
what kind of information can be stored in ORGANice.

== List of Attributes
In ORGANice, a person's data is represented by attributes. Attributes
refer to personal particulars such as name, type of person and blood type. +

The following list shows the list of attributes that can be specified for
a person and the criteria for valid inputs:

*List of Attributes*:

* n/**NAME**: the name of the person
** Applicable to: patients, doctors, donors
** Valid input: alphabets

* t/**TYPE**: the type of person
** Applicable to: patients, doctors, donors
** Valid input: patient/donor/doctor

* o/**ORGAN**: the type of organs
** Applicable to: patients, donors
** Valid input: kidney

* b/**BLOODTYPE** - the blood type of the person
** Applicable to: patients and donors
** Valid input: A/B/AB/O

* p/**PHONE** - contact number of a person
** Applicable to: patients, doctors, donors
** Valid input: 8 digit number sequence, starting with 6, 8 or 9

* ic/**NRIC** - NRIC number of a person
** Applicable to: patients, doctors and donors
** Valid input: any sequence of alphabets and numbers that fulfill these criteria:
*** starts with a capital S, F, T, or G
*** followed by a 7 digit number sequence
*** ends with a capital letter

* pr/**PRIORITY** - priority of the patient, the value of which is determined by a doctor
** Applicable to: patients
** Valid input: high/medium/low

* a/**AGE** - age of a person
** Applicable to: patients and donors
** Valid input: a number from 0 (inclusive) to 150 (inclusive)

* d/**DOCTOR** - doctor in charge of a patient
** Applicable to: patients
** Valid input: NRIC of the doctor

* tt/**TISSUE TYPE** - the type of tissues
** Applicable to: patients and donors
** Valid input: a string of 6 numbers (from 1 - 12), separated by commas

* exp/**EXPIRY** - expiry date of a donor's organ
** Applicable to: donors
** Valid input: a valid date in DD-MMM-YYYY format


[[Features]]
== Features

This section will introduce you to the list of features and commands in this application.
Each feature is triggered by a command with a specific format. +

The list below explains how the format of the commands should be interpreted:
====
*Command Format*

* The first word in a command is the command word. The rest of the words are parameters, which
are either compulsory or optional. +
e.g. in a command `add n/**NAME** p/**PHONE**`, `add` is the command word while `n/**NAME** p/**PHONE**`
are parameters.
* Words in bold are the parameters to be supplied by the user +
e.g. in `add **n/NAME**`, `**NAME**` is a parameter which can be used as `add n/John Doe`.
* Parameters can be in any order +
e.g. if the command specifies `n/**NAME** p/**PHONE**`, `p/**PHONE** n/**NAME**`
is also acceptable.
====

=== Viewing help : `help`
There may be times where you do not understand how ORGANice works, or you need a simple reminder on how to use
ORGANice. To access the user guide of ORGANice, you can do the following:

. Type `help` in the Command Box and press kbd:[Enter].
. A new window is launched, as shown in Figure 3. Open the link in a browser to read this document.
. Click the x button to close the window and return to the default display.

.**Help Window**

image::HelpWindow.png[width="790"]

=== Adding a person: `add`

This command allows you to add a patient, doctor, or donor to ORGANice with the attributes given,
depending on what is specified.

There are two methods to add a person:

* Method 1: Normal Add
* Method 2: Add with system prompting

To understand how to add a person via the 'Normal Add' method, go to <<Normal Add>>.
To understand how to add a person via the 'Add with system prompting' method, go to <<Add with system prompting>>.


==== Normal Add

Normal add refers to specifying all the attributes in the command. To add, type in the following
commands to add a person:

Format for adding patients: `add t/patient n/**NAME** o/**ORGAN** b/**BLOOD TYPE** tt/**TISSUE TYPE**
p/**PHONE** pr/**PRIORITY** ic/**NRIC** d/**DOCTOR** a/**AGE**` +

Format for adding donors: `add t/donor n/**NAME** o/**ORGAN** b/**BLOOD TYPE** tt/**TISSUE TYPE**
p/**PHONE** ic/**NRIC** exp/**EXPIRY** a/**AGE**` +

Format for adding doctors: `add t/doctor n/**NAME** ic/**NRIC** p/**PHONE**`

After adding a person, ORGANice will display a form which contains the attributes of the person. Press
kbd:[Enter] to confirm the details.

[TIP]
View the List of Attributes in the beginning of <<Features>> to find out what each attribute mean.

Examples:

* `add t/patient n/John Doe o/kidney b/A tt/1,2,3,4,5,6 p/98765432 pr/high ic/S9988330G
d/S2235456D a/29`
* `add t/donor n/Betsy Kim o/kidney b/AB tt/2,5,7,8,9,10 p/99998888 ic/S2345678H
exp/23-Nov-2020 a/21`
* `add t/doctor n/Lim Chu Kang p/91054444 ic/S5678908D`

==== Add with system prompting

In this mode, instead of typing a long command at one go, you can add a person's attributes one by one.
After entering an attribute, the system will prompt you to input another attribute.

To add a person in this mode, enter the following command of the format: `add t/**TYPE**`

ORGANice will prompt you to type in each attribute, one by one until all the fields are filled.
Here are some special commands that might be useful when you are in the process of filling up the form:

* `/abort` - The command to abandon the current form that you are currently filling.
* `/undo` - The command to undo the last entry that you entered, which is useful when you want to undo any changes made.
* `/done` - The command to indicate that you are done with filling all the required attributes and want to add the person into the application.
* `/exit` - The command to exit the application.

Note that `/exit`, `/abort`, and `/undo` commands can be used at any point in time, while `/done` command can only be used once all the required attributes have been specified.

These are the important commands for this feature, so now let's take a look at an example of this how this feature can be used.
When you want to add a `Patient`, type `add t/patient` in the `Command Box`. Three changes will occur on your screen:

* A form will appear in the space where the `Person List` used to occupy.
* The `Message Display Box` will display a message that prompts you to enter the patientâ€™s name.
* There is a `Progress Bar` detailing how much of the form is filled.

Refer to the `Figure 4` to see how the resulting screen will look like.

.Screenshot of the screen after you have successfully entered the `Form` mode
image::addForm.png[width="790"]

If you want to add a patient named "John Doe", type `John Doe` and then press kbd:[Enter].
After entering the name, the patient's name will be displayed on the form and the progress bar will increase indicating your progress in filling up the form as seen in `Figure 5`.

.Form layout after you have entered a valid name
image::nameFilled.png[width="790"]

Each time you type an input, ORGANice will check if it is a valid input. If the input is valid, it will be reflected on the form.
If not, ORGANice will display a warning message stating the criteria for a valid input of that attribute.

Say you typed in "G999999999A" and pressed kbd:[Enter] when ORGANice prompts you to type in the NRIC of the patient.
Three changes occur to ORGANice, which can be seen in the `Figure 6`:

* Your input will remain in the `Command Box`, but the colour of the input text turns to red.
* An error message is displayed in the `Message Display Box`. This error message details the criteria for a valid NRIC input. This error message is specific to the attribute type. For example if you typed in an invalid NRIC, an error message detailing the criteria for a valid NRIC will be displayed.
* Your input will not be reflected in the form.

.Form layout if you entered an invalid value
image::invalidInput.png[width="790"]

After all of the attributes have been specified, you can type in:

* `/done` to add the person to the ORGANice list of persons
* Click the `Find Match` button to directly add the person and find the potential donors at the same time.
Note that the `Find Match` button will only appear on the `Patient` form.

The `Figure 7` will show how the form will look like after you have entered all the required attributes.

.Form layout after all the required attributes have been specified
image::allFieldSpecified.png[width="790"]

When you type in `/done`, the Person List will return to its original state of displaying people in ORGANice.
The Message Display Box will show a success message, indicating that you have successfully added a new person to the Person List as seen in `Figure 8`.

.The UI changed back to it's original state and shows a success message
image::addSuccess.png[width="790"]

The `Find Match` button will appear when the list is fully filled. You can click this button and you will be shown a list of potential donors as seen in `Figure 10`. Note that the Find Match button will only appear on the Patient form.
Refer to `Figure 7` on where you can find the `Find Match` button

.The UI displayed the potential donors for a patient that you have added
image::findMatch.png[width="790"]

At any point in time, if you decided not to proceed with the addition and typed in `/abort`, you will be directed into the main page and notified that
you have abandoned the form as seen in `Figure 10`.

.The UI changed back to it's original state and shows a message the form has been abandoned
image::abandonForm.png[width="790"]

Furthermore, if you made any mistake while you are filling up the form, you can type in `/undo` to remove the last entry you entered.
For example, if you enter the wrong name and want to undo the action, type `/undo` in the `Command Box` and press kbd:[Enter]. Your previous input for the name will be removed from the form as seen in `Figure 11`

.Form layout showing that the last entry is removed after you typed in `/undo`
image::undoCommand.png[width="790"]

=== Listing persons : `list`

Shows a list of all doctors, donors, or patients in ORGANice, depending on the type of person specified. Shows all
persons in ORGANice if no type is specified.

Format: `list`

Optional parameters: Type parameter - `t/TYPE`

Examples:

* `list` +
Lists all patients, doctors and donors in the records.
* `list t/patient` +
Lists all patients only.

=== Editing a person : `edit`

Edits the information of the person with the specified NRIC to the attributes specified.
It is up to the user to specify which attributes should be updated. +

Format: `edit **NRIC**`

Examples:

* `edit S8732457G p/91234567` +
Edits the phone number of the specified patient to be `91234567`.
* `edit S8732457G n/Betsy Crower p/91234567` +
Edits the name and phone number of the specified donor to be `Betsy Crower` and `91234567` respectively.

// tag::find[]
=== Finding persons by attributes: `find`

You can use the `find` command to search for persons whose attributes match your input keywords. Matching persons will
be displayed in a list. +

Format: `find __PREFIX__/__KEYWORD__`

Optional parameters: Multiple `keywords` per `prefix`, multiple `prefixes` in the same find command.

The find command performs case insensitive `OR` matching within a prefix and `AND` matching between prefixes. The
following example illustrates this concept:

.Find command with multiple prefixes and multiple keywords per prefix.
image::findByPrefix.png[width="790"]

As seen from Figure 12, `find n/Duncan n/Lionel n/Helen t/patient t/donor` displays 'Duncan Chua', `Lionel Doe` and
`Helen Davidson`. This is due to the fact that Duncan's name matches either of 'Duncan' `OR` 'Lionel' `OR` 'Helen' `AND`
he is also either a 'doctor' `OR` 'donor'. The same is true for Lionel and Helen. You should note that the only
exception to this rule is tissue type matching, which uses `AND` matching within the prefix.

You may wish to reference the following section: <<List of Attributes>>, to view the list of available prefixes to
search by.

Here are some examples and pointers showcasing the use of `find`:

__Use case with single prefix and keyword__ +
* `find n/Alice` +
Displays all persons whose name contains 'Alice'

__Use case demonstrating keyword case insensitivity__ +
* `find n/aLiCe` +
Displays the same result as the preceding example.

__Use case with multiple keywords per prefix__ +
* `find n/Alice n/Benson b/A b/B b/O` +
Displays all persons whose name contains either 'Alice' or 'Benson' and whose blood type is either 'A', 'B' or 'O'.

__Use case demonstrating prefix order insensitivity__ +
* `find b/A n/Benson b/O n/Alice b/B` +
Displays the same result as the preceding example.

__Use case demonstrating full name capture__ +
* `find n/Laura Bailey n/Marisha Ray` +
Displays all persons whose name contains 'Laura Bailey' or 'Marisha Ray'.

__Use case demonstrating tissue type finding__ +
* `find tt/4,1,2,3` +
Displays all persons whose tissue type contains tissues: 4, 1, 2 and 3; in any order.

=== Detecting matches: `match`

This command runs a kidney matching test on patients and donors in ORGANice and displays the match results.
Refer to <<FAQ>> for a better understanding of the procedure for kidney matching.

You can either run a kidney matching test on a specific patient or on all patients in ORGANice.
To learn how to run kidney matching tests on a specific patient,
refer to <<Matching a specific patient>>.
To learn how to run kidney matching tests on all patients,
refer to <<Matching all patients>>.

==== Matching a specific patient
This section will explain how to run kidney matching tests on a specific patient and run you through an example.
To find all matching donors of a specific patient,
type in a command of the format `match ic/**PATIENT NRIC**`.

Here is an example. Suppose you want to match a specific patient called "John Doe" and his NRIC is "S1234568R".
You will have to type `match ic/S1234568R` in the Command Box and press kbd:[Enter].

You will see a list of matching donors with John Doe along with the success
rate of matching, similar to Figure 13.

//TODO need to change this to another screenshot
.List of Donors that match John Doe
image::MatchingDonorsDisplayed.png[width=790]

For more information on the success rate, you may refer to <<FAQ>>.

==== Matching all patients
This section will explain how to run kidney matching tests on all patients stored in ORGANice and run you
through an example.
To match all the patients in ORGANice,
type `match ic/all` in the Command Box and press kbd:[Enter].

You will see a list of all the patients in ORGANice along with the number of
matching donors for each patient has.

//TODO change the Figure name as more diagrams are added.
An example is shown in Figure 13 below, with the following explanation: +
For example, you have three patients named 'Someone edited',
'Gary Tennant' and 'Elle Brady' respectively stored in ORGANice. Some donors are also stored in ORGANice.
If you type `match ic/all` in the Command Box and press kbd:[Enter], you will see 'Someone edited', 'Gary Tennant'
and 'Elle Brady' along with the number of matching donors each patient has.

.List of Persons with number of matching donors
image::PatientMatchResults.png[width=790]


Following this, you can sort the matches based on different categories to deduce which patient to prioritize.
Refer to <<Sorting matches: `sort`>> for more information.

=== Sorting matches: `sort`
After matching patients and donors, you can sort the list of matches to determine which patient to prioritize for organ transplant.

**The sort command can only be used after a match command** to sort the resulting list of patient-donor pairs generated.
There are three categories by which you can sort the matches, namely:

* Sorting based on donor's organ expiry date
+
* Sorting based on priority
+
* Sorting based on success rate of match
+


These categories are further elaborated below. Note that **only one category can be used in one sort command**.

==== Sorting based on donor's organ expiry date
This category sorts a list of matched donors belonging to a particular patient based on the donated organ's expiry date (from the earliest to the latest expiry date).

This allows you to determine which organs are expiring soon so that you can prioritize them for organ transplant.

Format: `sort expiry`

Example: +
After running a match command on a specific patient with `match ic/**NRIC**`, you will get the list of donors that are compatible with said patient.
You can then run `sort expiry` to obtain the list of donors with the earliest organ expiration date at the top of the list.

==== Sorting based on priority
This category sorts a list of matched patients based on their priority (from highest to lowest). You may refer to <<Glossary>> for more information on priority.

This allows you to determine which patient to prioritize for organ transplant.

Format: `sort priority`

Example: +
After running `match ic/all`, you will obtain a list of patients.
You can then run `sort priority` to obtain a list with high priority patients at the top of the list.

Note:

* In cases where patients have the **same priority**, those with more matched donors will be displayed first.
If these two factors are the same for a group of patients, they will be displayed according to their names in alphabetical order.

==== Sorting based on success rate of match
This category sorts the list of matched donors belonging to a particular patient based on the success rate of the match (from highest to lowest).
(Refer to <<Glossary>> for more information on success rate.)

This allows you to determine which patient-donor pair has the highest compatibility and are safe to proceed for organ transplant.

Format: `sort rate`

Example: +
After running a match command on a specific patient with `match ic/**NRIC**`, you will get the list of donors that are compatible with said patient.
You can then run `sort rate` to obtain the list of donors with the highest success rate at the top of the list.  +

=== Processing potential matches: `processing`
//TODO: change to shorter term that captures the meaning

After finding a list of matches, the hospital is free to schedule a cross-matching test between
a specific donor and patient. +

After typing this command, the following changes occur:

* A list will be generated to show the necessary tasks the hospital need to do for the respective donor and patient.
* The list will be unique to the specific donor and patient pair
* The list can be updated using `done** TASK NUMBER**` +

The list will be saved after the command `exit` is executed. The page will then stop displaying the list.

Format: `processing ic/**PATIENT NRIC** ic/**DONOR NRIC**` +
The order of the NRICs does not matter.

Example:
`processing ic/S6764235G ic/S1234567D`


=== Mark as done : `done`

After the hospital has the results of the cross matching test, they can
update the results in ORGANice. Cross matching tests have two possible results: pass or fail.

Format: `done icP/**NRIC OF PATIENT** icD/**NRIC OF DONOR** res/[pass/fail]`

`icP/**NRIC OF PATIENT**` refers to the NRIC of the patient, while `icD/**NRIC OF DONOR**`
refers to the NRIC of the donor.

The following section outlines what happens based on the two results: +

If the result of the cross matching is a 'pass':

. It is up to the hospital staff to schedule an organ transplant surgery
between the patient and donor.
. Mark the patient and donor as 'done', based on the command format.
. After running the command, the system removes the patient and donor from the matching pool.
The patient and donor statuses will be marked to 'done'.


If the result of the cross matching is a 'fail': +

. Run the command based on the given format

. The patient and donor will be added back to the matching pool for
match detection with other patients and donors.

. The patient-donor pair will not be considered a potential match in future match detection.


Example:

* `done icP/S7896432A icD/S4578902G res/pass`
* `done icP/S7896432A icD/S4578902G res/fail`


=== Exiting the program : `exit`

To exit ORGANice, type `exit` in the Command Box. ORGANice will close on its own.

=== Saving the data

Data is saved in the hard disk automatically after any command that changes the data. +
There is no need to save manually.

=== Detecting duplicates

When adding a person, ORGANice will detect if the input is a duplicate of another person in the list.
A duplicate is defined as: Two persons of the same type who have the same NRIC.

When a duplicate is detected, ORGANice will indicate that there is such a person in ORGANice so the inputs
should be changed.

== Future improvements

This section describes features that can be added or improved in version 2.0.
It is further divided into two sub-sections: **Proposed New Features** and **Proposed Extensions**.

=== Proposed New Features

This section describes features that can be added to ORGANice in version 2.0.

==== Filtering persons: `filter`

Filters a patient/doctor/donor by specific attributes.

Format: `filter [patient/donor/doctor] [options]`

Returns a list of patients/doctors/doctors that has the specified attributes.

Examples:

* `filter t/patient g/M`
* `filter t/donor g/M n/Chua`

=== Proposed Extensions

This section describes features that can be improved on and its proposed improvements.

==== Mass addition of data

Add more than one patient/doctor/donor from data in a specified text file.

A duplicate is defined as: two persons of the same type having the same ID.
When a duplicate is detected, it prompts the user to change the data in the text file.

==== Supporting more types of transplants

Currently ORGANice has patient-donor matching for kidneys only. Future versions can include matching for +
more types of organs.

==== Processing a match: `process`

Emails the doctor in charge of a patient when an organ match for the patient is found.

Format: `process **NRIC**`

==== Advanced find

Finding in v2.0 is more advanced with the implementation of fuzzy search and partial matching of keywords.


== FAQ

*Q*: How do I transfer my data to another computer? +
*A*: Install the app in the other computer and overwrite the empty data file it creates with the file +
that contains the data of your previous ORGANice folder.

*Q*: What are the steps to find a patient-donor kidney match? +
*A*: There are three steps to finding a patient-donor match:

1. Do a blood test to determine donor and patient blood type.
2. Do a tissue typing test to determine the HLA antigens of the patient and the donor.
3. Do a cross match, which is a trial transfusion.

*Q*: What is the success rate and how is it computed? +
*A*: The success rate measures the tissue compatibility between a donor and a patient. It is computed via this formula: (number of common tissue types between donor and patient) / 6 * 100%

== Command Summary

This section summarises the commands to use this application. The following list
contains the summary of the commands.

* *Add (Normal Mode):*
** Add patient: `add t/patient n/NAME o/ORGAN b/BLOOD TYPE tt/TISSUE TYPE p/PHONE pr/PRIORITY ic/NRIC d/DOCTOR a/AGE`
** Add donor: `add t/donor n/**NAME** o/**ORGAN** b/**BLOOD TYPE** tt/**TISSUE TYPE**
p/**PHONE** ic/**NRIC** exp/**EXPIRY** a/**AGE**`
** Add doctor: `add t/doctor n/**NAME** ic/**NRIC** p/**PHONE*`

* *Add (System Prompt Mode)*: `add t/**TYPE**`

* *Edit* : `edit **NRIC**`
** Optional parameters: any parameter from <<List of Attributes>>
* *Find* : `find`
** Optional parameters: any parameter from <<List of Attributes>>
* *Match* : `match [all/ic]`
** Optional parameters: `sort/[rate/expiry/priority]` +
* *Processing*: `processing icP/**NRIC of Patient** icD/**NRIC OF DONOR**`
* *List* : `list t/**TYPE**`
* *Help* : `help`
* *Done* : `done icP/**NRIC of Patient** icD/**NRIC OF DONOR** `
* *Exit* : `exit`

== Glossary

This section contains a list of words used in this user guide and its intended meaning.
It is meant to clarify the meaning and context of the words used in this user guide.

* user: refers to hospital administration staff who are using this desktop application

* person: refers to doctors, patients or donors

* blood type match: refers to a donor and patient whose blood types are compatible.

* tissue match: refers to a donor and patient whose tissues match

* cross match: a trial blood transfusion, where donor and patient's blood are mixed in a test tube to check +
for harmful interactions between patient and donor's blood

* potential match: refers to a donor-patient pair whose organs pass the blood test and tissue typing test.

* match: refers to a donor-patient pair whose organs pass all three matching tests

* duplicate: refers to two persons of the same type which have the same NRIC

* success rate: refers to a number which indicates the degree of compatibility between the patient and donor. This percentage is calculated from the number of tissue matches between the patient and donor.

* priority: used to indicate the level of importance or urgency of getting organ transplant for the patient. The different levels are include high, medium and low, and it is specified by the doctor after an assessment.
